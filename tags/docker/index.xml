<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Docker on kiennt26's home</title><link>https://ntk148v.github.io/tags/docker/</link><description>Recent content in Docker on kiennt26's home</description><generator>Hugo</generator><language>en-us</language><managingEditor>kiennt2609@gmail.com (Kien Nguyen-Tuan)</managingEditor><webMaster>kiennt2609@gmail.com (Kien Nguyen-Tuan)</webMaster><lastBuildDate>Tue, 12 Dec 2023 14:49:04 +0700</lastBuildDate><atom:link href="https://ntk148v.github.io/tags/docker/index.xml" rel="self" type="application/rss+xml"/><item><title>A clumsy Docker network notes</title><link>https://ntk148v.github.io/posts/clumsy-docker-network-notes/</link><pubDate>Tue, 12 Dec 2023 14:47:26 +0700</pubDate><author>kiennt2609@gmail.com (Kien Nguyen-Tuan)</author><guid>https://ntk148v.github.io/posts/clumsy-docker-network-notes/</guid><description>&lt;h1 id="a-clumsy-docker-networking-notes">A clumsy Docker networking notes&lt;/h1>
&lt;p>Nguồn:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/ntk148v/til/tree/master/docker/networking">https://github.com/ntk148v/til/tree/master/docker/networking&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://argus-sec.com/docker-networking-behind-the-scenes/">https://argus-sec.com/docker-networking-behind-the-scenes/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.docker.com/network/">https://docs.docker.com/network/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/KamranAzeem/learn-docker/blob/master/docs/docker-networking-deep-dive.md">https://github.com/KamranAzeem/learn-docker/blob/master/docs/docker-networking-deep-dive.md&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.docker.com/engine/tutorials/networkingcontainers/">https://docs.docker.com/engine/tutorials/networkingcontainers/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.docker.com/network/iptables/">https://docs.docker.com/network/iptables/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dev.to/polarbit/how-docker-container-networking-works-mimic-it-using-linux-network-namespaces-9mj">https://dev.to/polarbit/how-docker-container-networking-works-mimic-it-using-linux-network-namespaces-9mj&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="khái-niệm">Khái niệm&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Các khái niệm:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://man7.org/linux/man-pages/man8/ip-netns.8.html">Network namespace&lt;/a>:&lt;/p>
&lt;ul>
&lt;li>Trước khi đi vào network namespace, cần hiểu về &lt;strong>Namespace&lt;/strong>. Namespace là một tính năng của Linux kernel để phân vùng tài nguyên của kernel sao cho một tập hợp các process chỉ nhìn thấy tập hợp các tài nguyên (trong namespace đó) trong khi một tập hợp các process khác nhìn thấy tập các tài nguyên khác (trong namespace khác). Tính năng này hoạt động bằng cách đưa tập các tài nguyên và process vào cùng một namespace, các namespace khác nhau sẽ tham chiếu đến các tài nguyên riêng biệt. Tài nguyên có thể tồn tại trong nhiều không gian. Ví dụ về các tài nguyên như vậy là process ID, hostname, user ID, tên file và một số tên (name) liên quan đến quyền truy cập mạng và giao tiếp giữa các process.&lt;/li>
&lt;li>Networking namespace là một trong các loại namespace. Mỗi network namespace có &lt;a href="https://en.wikipedia.org/wiki/Network_stack">network stack&lt;/a> riêng: địa chỉ IP, network interface, route table, &amp;hellip;&lt;/li>
&lt;li>Bạn có thể xem thao tác các network namespace bằng câu lệnh sau:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">$ sudo ip netns &amp;lt;sub-command&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://wiki.archlinux.org/index.php/Network_bridge">Network bridge&lt;/a>: một thiết bị mạng ảo chuyển tiếp các gói giữa hai hoặc nhiều phân đoạn mạng.&lt;/p></description></item><item><title>Docker and Iptables: You may do it wrong!</title><link>https://ntk148v.github.io/posts/docker-iptables/</link><pubDate>Tue, 25 Oct 2022 10:29:11 +0700</pubDate><author>kiennt2609@gmail.com (Kien Nguyen-Tuan)</author><guid>https://ntk148v.github.io/posts/docker-iptables/</guid><description>&lt;h2 id="mission">Mission&lt;/h2>
&lt;p>If you&amp;rsquo;re running Docker on a host that is exposed to the Internet (network bridge), you will probably want to restrict external access.&lt;/p>
&lt;h2 id="docker-network">Docker network&lt;/h2>
&lt;p>Let&amp;rsquo;s start with a fact that Docker manipulates &lt;code>iptables&lt;/code> rules to provide network isolation, on Linux. Docker installs custom iptables chains named &lt;code>DOCKER&lt;/code>, &lt;code>DOCKER-USER&lt;/code> and &lt;code>DOCKER-ISOLATION-STAGE-*&lt;/code>, and it ensures that incoming packets are always checked by these chains first.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">iptables -L -n
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Re.Docker network, I won&amp;rsquo;t describe here because it&amp;rsquo;s a lot of knowledge. You may want to check &lt;a href="https://github.com/ntk148v/til/blob/master/docker/networking/README.md">Docker network note&lt;/a>. I will only show iptables packet flow: For example, we have a host with ip 10.0.10.26, then start a container that is exposed port 8000 to internet.&lt;/p></description></item></channel></rss>