<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Author: Kien Nguyen <kiennt2609@gmail.com>
      A minimal Hugo theme with Tailwind CSS"><title>kiennt26's home
| A clumsy Docker network notes
</title><meta name=author content="map[email:kiennt2609@gmail.com name:Kien Nguyen-Tuan]"><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/favicon_io/favicon.ico type=image/x-icon><link rel=icon href=/favicon_io/favicon-16x16.png size=16x16 type=image/png><link rel=icon href=/favicon_io/favicon-32x32.png size=32x32 type=image/png><link rel=preload type=text/css href=/css/rose-pine.min.css integrity as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet type=text/css href=/css/rose-pine.min.css integrity></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Overpass+Mono:wght@400;500;700&family=Overpass:wght@400;500;700&display=swap" rel=stylesheet><link rel=preload type=text/css href="/css/toigian.min.b0f760f912c9912a782fcf5aa56659db826835ff1dc67d1b304b0e6430cd35fd.css" integrity="sha256-sPdg+RLJkSp4L89apWZZ24JoNf8dxn0bMEsOZDDNNf0=" as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet type=text/css href="/css/toigian.min.b0f760f912c9912a782fcf5aa56659db826835ff1dc67d1b304b0e6430cd35fd.css" integrity="sha256-sPdg+RLJkSp4L89apWZZ24JoNf8dxn0bMEsOZDDNNf0="></noscript><link rel=stylesheet type=text/css href="/css/light.min.29febe5c26ca625f7e2913e2509889a65637f415171eb003603102dea7cc42e0.css" integrity="sha256-Kf6+XCbKYl9+KRPiUJiJplY39BUXHrADYDEC3qfMQuA="><link rel=stylesheet type=text/css href="/css/dark.min.47fea451289f4f246c4875ba0aa5f6376183f220c766f5e90d15d6e48cb7b937.css" integrity="sha256-R/6kUSifTyRsSHW6CqX2N2GD8iDHZvXpDRXW5Iy3uTc="><script>localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><script async defer src=/js/main.dfa968b06ebe7fb755eb156f7296445f20bd5ca0c82aa2eb755b1bfac4e2f294676471cf7670590073c364901a0dd5dc4b4c7b83f7a4a3c3b081f085c78fa1de.js integrity="sha512-36losG6+f7dV6xVvcpZEXyC9XKDIKqLrdVsb+sTi8pRnZHHPdnBZAHPDZJAaDdXcS0x7g/eko8OwgfCFx4+h3g=="></script><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0,securityLevel:"loose"})</script></head><body><header style=--layer:10><div aria-hidden=true class="absolute top-[-1000px] left-0 z-[calc(var(--layer)+1)] h-[calc(1000px+var(--page-top))] w-full bg-base"></div><div class="fixed top-0 left-0 z-[var(--layer)] flex h-header-height w-full items-center border-b px-page-gutter before:absolute before:inset-0 before:z-[-1] before:bg-base [@supports(backdrop-filter:blur(0))]:before:bg-base [@supports(backdrop-filter:blur(0))]:before:backdrop-blur-md"><div class="lowercase italic mx-auto flex w-full max-w-content items-center justify-between"><nav class=mr-3><ol class="flex text-md items-center"><li><a href=/ class="text-muted focus:underline focus:outline-none pr-1 whitespace-nowrap">kiennt26's home</a></li><li class="text-muted focus:underline focus:outline-none pr-1 whitespace-nowrap">/</li><li><a href=/posts/ class="text-muted focus:underline focus:outline-none pr-1 whitespace-nowrap">Posts</a></li><li class="text-muted focus:underline focus:outline-none pr-1 whitespace-nowrap">/</li><li><a href=/posts/clumsy-docker-network-notes/ class="focus:underline focus:outline-none font-bold pr-1 hidden md:block">A clumsy Docker network notes</a></li></ol></nav><nav class=ml-3><ul class="flex text-md whitespace-nowrap"><li class=pl-2><a href=/contact class="tracking-wide hover:underline">Contact</a></li><li class=pl-2><a href=/posts class="tracking-wide hover:underline">Posts</a></li></ul></nav></div></div></header><main class="flex justify-center px-page-gutter py-page-top"><div class="min-h-content w-full max-w-content space-y-10 sm:space-y-20"><div class="lowercase italic mx-auto flex w-full max-w-content items-center justify-between"><nav class=mr-3><ol class="flex text-md items-center"><li><a href=/ class="text-muted focus:underline focus:outline-none pr-1 whitespace-nowrap">kiennt26's home</a></li><li class="text-muted focus:underline focus:outline-none pr-1 whitespace-nowrap">/</li><li><a href=/posts/ class="text-muted focus:underline focus:outline-none pr-1 whitespace-nowrap">Posts</a></li><li class="text-muted focus:underline focus:outline-none pr-1 whitespace-nowrap">/</li><li><a href=/posts/clumsy-docker-network-notes/ class="focus:underline focus:outline-none font-bold pr-1 hidden md:block">A clumsy Docker network notes</a></li></ol></nav><nav class=ml-3><ul class="flex text-md whitespace-nowrap"><li class=pl-2><a href=/contact class="tracking-wide hover:underline">Contact</a></li><li class=pl-2><a href=/posts class="tracking-wide hover:underline">Posts</a></li></ul></nav></div><article><h1>A clumsy Docker network notes</h1><time class="text-sm italic tabular-nums text-muted">2023/12/12&nbsp;</time>
<nobr class="text-sm text-muted">&#8674&nbsp;</nobr><time class="text-sm italic tabular-nums text-muted">2023/12/12&nbsp;</time><div class=section><a href=/tags/tech/ id=tag>Tech</a>
<a href=/tags/docker/ id=tag>Docker</a></div><div id=toc><details open><summary>Table of contents</summary><div id=toc-list><nav id=TableOfContents><ol><li><a href=#khái-niệm>Khái niệm</a></li><li><a href=#docker-và-network-namespace>Docker và network namespace</a></li><li><a href=#tản-mạn-qua-docker-networking-subsystem>Tản mạn qua Docker networking subsystem</a><ol><li><a href=#docker0---default-bridge-network>docker0 - default bridge network</a></li><li><a href=#user-defined-bridge-network>User-defined bridge network</a></li></ol></li><li><a href=#một-số-command-hay-ho>Một số command hay ho</a></li></ol></nav></div></details></div><div class=content><h1 id=a-clumsy-docker-networking-notes>A clumsy Docker networking notes</h1><p>Nguồn:</p><ul><li><a href=https://github.com/ntk148v/til/tree/master/docker/networking>https://github.com/ntk148v/til/tree/master/docker/networking</a></li><li><a href=https://argus-sec.com/docker-networking-behind-the-scenes/>https://argus-sec.com/docker-networking-behind-the-scenes/</a></li><li><a href=https://docs.docker.com/network/>https://docs.docker.com/network/</a></li><li><a href=https://github.com/KamranAzeem/learn-docker/blob/master/docs/docker-networking-deep-dive.md>https://github.com/KamranAzeem/learn-docker/blob/master/docs/docker-networking-deep-dive.md</a></li><li><a href=https://docs.docker.com/engine/tutorials/networkingcontainers/>https://docs.docker.com/engine/tutorials/networkingcontainers/</a></li><li><a href=https://docs.docker.com/network/iptables/>https://docs.docker.com/network/iptables/</a></li><li><a href=https://dev.to/polarbit/how-docker-container-networking-works-mimic-it-using-linux-network-namespaces-9mj>https://dev.to/polarbit/how-docker-container-networking-works-mimic-it-using-linux-network-namespaces-9mj</a></li></ul><h2 id=khái-niệm>Khái niệm</h2><ul><li><p>Các khái niệm:</p><ul><li><p><a href=https://man7.org/linux/man-pages/man8/ip-netns.8.html>Network namespace</a>:</p><ul><li>Trước khi đi vào network namespace, cần hiểu về <strong>Namespace</strong>. Namespace là một tính năng của Linux kernel để phân vùng tài nguyên của kernel sao cho một tập hợp các process chỉ nhìn thấy tập hợp các tài nguyên (trong namespace đó) trong khi một tập hợp các process khác nhìn thấy tập các tài nguyên khác (trong namespace khác). Tính năng này hoạt động bằng cách đưa tập các tài nguyên và process vào cùng một namespace, các namespace khác nhau sẽ tham chiếu đến các tài nguyên riêng biệt. Tài nguyên có thể tồn tại trong nhiều không gian. Ví dụ về các tài nguyên như vậy là process ID, hostname, user ID, tên file và một số tên (name) liên quan đến quyền truy cập mạng và giao tiếp giữa các process.</li><li>Networking namespace là một trong các loại namespace. Mỗi network namespace có <a href=https://en.wikipedia.org/wiki/Network_stack>network stack</a> riêng: địa chỉ IP, network interface, route table, &mldr;</li><li>Bạn có thể xem thao tác các network namespace bằng câu lệnh sau:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ sudo ip netns &lt;sub-command&gt;
</span></span></code></pre></div></li><li><p><a href=https://wiki.archlinux.org/index.php/Network_bridge>Network bridge</a>: một thiết bị mạng ảo chuyển tiếp các gói giữa hai hoặc nhiều phân đoạn mạng.</p></li><li><p><strong>Veth pair</strong>: hiểu đơn giản là virtual network cable nối giữa 2 network interface device (NIC).</p></li></ul></li><li><p>Về cơ bản, Docker sử dụng các tính năng trên như sau:</p></li></ul><p><img src=https://res.cloudinary.com/practicaldev/image/fetch/s--tGvJLH6y--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/pszchqfvcjpl13dextrc.png alt></p><h2 id=docker-và-network-namespace>Docker và network namespace</h2><blockquote><p>Ví dụ sau lấy theo các thông số, cấu hình mặc định khi chạy Docker container.</p></blockquote><ul><li>Khi tạo và chạy 1 container, Docker đồng thời tạo ra một network namespace riêng cho container đó. Sau đó, Docker kết nối network của container đó với Linux bridge <strong>docker0</strong> bằng veth pair.</li><li>Như ở trên đã nói, để xem danh sách network namespace, gõ câu lệnh sau:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ sudo ip netns list
</span></span><span class=line><span class=cl><span class=c1># Start a container</span>
</span></span><span class=line><span class=cl>$ docker run --name nstest -it busybox
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Open another terminal session</span>
</span></span><span class=line><span class=cl>$ sudo ip netns list
</span></span><span class=line><span class=cl><span class=c1># nothing return</span>
</span></span></code></pre></div><ul><li>Hmm, không có gì trả về. Mặc định Docker không thêm container network namespace vào trong Linux runtime data, bạn có thể tạo softlink cho network namespace đó:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># Get container process id.</span>
</span></span><span class=line><span class=cl>$ <span class=nv>pid</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>docker inspect -f <span class=s1>&#39;{{.State.Pid}}&#39;</span> nstest<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Soft link the network namespace</span>
</span></span><span class=line><span class=cl>$ sudo mkdir -p /var/run/netns/
</span></span><span class=line><span class=cl>$ sudo ln -sf /proc/<span class=nv>$pid</span>/ns/net /var/run/netns/nstest
</span></span><span class=line><span class=cl>$ sudo ip netns list
</span></span><span class=line><span class=cl>nstest <span class=o>(</span>id: 0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=c1># ^ this, it works.</span>
</span></span></code></pre></div><ul><li>Chạy vào network namespace, như đã nói, mỗi network namespace có network stack riêng:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ docker <span class=nb>exec</span> nstest ip a
</span></span><span class=line><span class=cl>docker <span class=nb>exec</span> nstest ip a
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>7: eth0@if8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu <span class=m>1500</span> qdisc noqueue
</span></span><span class=line><span class=cl>    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sudo ip netns <span class=nb>exec</span> nstest ip a
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>7: eth0@if8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc noqueue state UP group default
</span></span><span class=line><span class=cl>    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl>    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl><span class=c1># ^ result is the same as docker exec command.</span>
</span></span><span class=line><span class=cl>$ ip a <span class=p>|</span> grep docker
</span></span><span class=line><span class=cl>5: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc noqueue state UP group default
</span></span><span class=line><span class=cl>    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
</span></span><span class=line><span class=cl>8: veth4866e91@if7: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc noqueue master docker0 state UP group default
</span></span></code></pre></div><ul><li>Ở đây, eth0@if8 trong container namespace đang kết nối với interface veth4866e91@if7 trên docker0 bridge.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ brctl show
</span></span><span class=line><span class=cl>bridge name     bridge id               STP enabled     interfaces
</span></span><span class=line><span class=cl>docker0         8000.0242f0c749bd       no              veth4866e91 <span class=c1># this</span>
</span></span><span class=line><span class=cl>lxdbr0          8000.00163e2afe62       no
</span></span></code></pre></div><h2 id=tản-mạn-qua-docker-networking-subsystem>Tản mạn qua Docker networking subsystem</h2><p>Kiến trúc Docker networking subsystem dạng pluggable, có thể mở rộng sử dụng drivers. Mặc định, có những drivers sau: <code>bridge</code>, <code>host</code>, <code>none</code>, <code>overlay</code>, <code>macvlan</code>, <code>ipvlan</code>.</p><p>Trong bài viết này, chủ yếu nói đến <code>bridge</code> driver.</p><h3 id=docker0---default-bridge-network>docker0 - default bridge network</h3><p><img src=https://docs.docker.com/engine/tutorials/bridge1.png alt></p><ul><li>Mặc định, tất cả container đều kết nối với docker0.</li><li>Docker engine khi start up sẽ tìm một subnet không được sử dụng (bắt đầu trong một danh sách fixed trong code) và gán IP đầu tiên cho docker0. Như trong trường hợp của tui, đó là <code>172.17.0.1/16</code>.</li><li>Nếu không có containers nào chạy và kết nối với docker0, trạng thái của docker0 là DOWN.</li><li>Các containers kết nối với docker0, kế thừa cấu hình DNS của host: <code>/etc/hosts</code> and <code>/etc/resolv.conf</code>.</li><li>Lưu ý, ở docker0 bridge, không có tính năng <strong>service discovery</strong>, do vậy, các containers phải giao tiếp thông qua địa chỉ IP.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># Start a second container</span>
</span></span><span class=line><span class=cl>$ docker run --name nstest2 -it busybox
</span></span><span class=line><span class=cl>/ <span class=c1># ip a</span>
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>9: eth0@if10: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu <span class=m>1500</span> qdisc noqueue
</span></span><span class=line><span class=cl>    link/ether 02:42:ac:11:00:03 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 172.17.0.3/16 brd 172.17.255.255 scope global eth0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>/ <span class=c1># ping nstest</span>
</span></span><span class=line><span class=cl>ping: bad address <span class=s1>&#39;nstest&#39;</span>
</span></span><span class=line><span class=cl>/ <span class=c1># ping 172.17.0.2</span>
</span></span><span class=line><span class=cl>PING 172.17.0.2 <span class=o>(</span>172.17.0.2<span class=o>)</span>: <span class=m>56</span> data bytes
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 172.17.0.2: <span class=nv>seq</span><span class=o>=</span><span class=m>0</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.263 ms
</span></span><span class=line><span class=cl>^C
</span></span><span class=line><span class=cl>--- 172.17.0.2 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>1</span> packets transmitted, <span class=m>1</span> packets received, 0% packet loss
</span></span><span class=line><span class=cl>round-trip min/avg/max <span class=o>=</span> 0.263/0.263/0.263 ms
</span></span></code></pre></div><h3 id=user-defined-bridge-network>User-defined bridge network</h3><ul><li>Người dùng có thể tự tạo Docker network.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ docker network create mynet
</span></span><span class=line><span class=cl>ed7da300a506e6e9be68b8f69d1b857dd7cc8db2a9d51c4b85dba37976780293
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ docker network ls
</span></span><span class=line><span class=cl>NETWORK ID     NAME      DRIVER    SCOPE
</span></span><span class=line><span class=cl>935865833d99   bridge    bridge    <span class=nb>local</span>
</span></span><span class=line><span class=cl>f753aeafa1a1   host      host      <span class=nb>local</span>
</span></span><span class=line><span class=cl>ed7da300a506   mynet     bridge    <span class=nb>local</span>
</span></span><span class=line><span class=cl>6b0488ceccc8   none      null      <span class=nb>local</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ docker network inspect mynet
</span></span><span class=line><span class=cl><span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Name&#34;</span>: <span class=s2>&#34;mynet&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Id&#34;</span>: <span class=s2>&#34;ed7da300a506e6e9be68b8f69d1b857dd7cc8db2a9d51c4b85dba37976780293&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Created&#34;</span>: <span class=s2>&#34;2023-12-12T09:37:34.358888862+07:00&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Scope&#34;</span>: <span class=s2>&#34;local&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Driver&#34;</span>: <span class=s2>&#34;bridge&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;EnableIPv6&#34;</span>: false,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;IPAM&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Driver&#34;</span>: <span class=s2>&#34;default&#34;</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Options&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Config&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;Subnet&#34;</span>: <span class=s2>&#34;172.18.0.0/16&#34;</span>,
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;Gateway&#34;</span>: <span class=s2>&#34;172.18.0.1&#34;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>]</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Internal&#34;</span>: false,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Attachable&#34;</span>: false,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Ingress&#34;</span>: false,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;ConfigFrom&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Network&#34;</span>: <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;ConfigOnly&#34;</span>: false,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Containers&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Options&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Labels&#34;</span>: <span class=o>{}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check with ip addr show, it should show up as a network</span>
</span></span><span class=line><span class=cl><span class=c1># inteface on the host with the name br-&lt;Network ID substring&gt;</span>
</span></span><span class=line><span class=cl>$ ip addr show
</span></span><span class=line><span class=cl><span class=c1># ...</span>
</span></span><span class=line><span class=cl>11: br-ed7da300a506: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu <span class=m>1500</span> qdisc noqueue state DOWN group default
</span></span><span class=line><span class=cl>    link/ether 02:42:f8:36:9b:e0 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 172.18.0.1/16 brd 172.18.255.255 scope global br-ed7da300a506
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ brctl show
</span></span><span class=line><span class=cl>bridge name     bridge id               STP enabled     interfaces
</span></span><span class=line><span class=cl>br-ed7da300a506 8000.0242f8369be0       no
</span></span><span class=line><span class=cl>docker0         8000.0242f0c749bd       no
</span></span><span class=line><span class=cl>lxdbr0          8000.00163e2afe62       no
</span></span></code></pre></div><ul><li>Không giống docker0 bridge, network mới có DNS-based service discovery:<ul><li>Ở đây, sử dụng custom image <code>praqma/network-multitool</code> để có đủ commands và tools, có thể sử dụng image bất kỳ và cài đặt tool tương tự.</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ docker run --name<span class=o>=</span>web --network<span class=o>=</span>mynet -d wbitt/network-multitool
</span></span><span class=line><span class=cl>e2d841b7a02916aa25a2fa5ceace0427ad7c0ccc967ad01fb5cc423460f0e990
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ docker run --name<span class=o>=</span>db --network<span class=o>=</span>mynet -e <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span>secret -d mysql
</span></span><span class=line><span class=cl>492ba8a9277d96876f0a605d9434723aed774978a40023e778a97815216754f0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ docker ps
</span></span><span class=line><span class=cl>CONTAINER ID   IMAGE                     COMMAND                  CREATED              STATUS              PORTS                                  NAMES
</span></span><span class=line><span class=cl>e2d841b7a029   wbitt/network-multitool   <span class=s2>&#34;/bin/sh /docker/ent…&#34;</span>   <span class=m>15</span> seconds ago       Up <span class=m>14</span> seconds       80/tcp, 443/tcp, 1180/tcp, 11443/tcp   web
</span></span><span class=line><span class=cl>492ba8a9277d   mysql                     <span class=s2>&#34;docker-entrypoint.s…&#34;</span>   About a minute ago   Up About a minute   3306/tcp, 33060/tcp                    db
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ping each other</span>
</span></span><span class=line><span class=cl>$ docker <span class=nb>exec</span> -it web bash
</span></span><span class=line><span class=cl>e2d841b7a029:/# ping -c <span class=m>1</span> db
</span></span><span class=line><span class=cl>PING db <span class=o>(</span>172.18.0.2<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from db.mynet <span class=o>(</span>172.18.0.2<span class=o>)</span>: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.096 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- db ping statistics ---
</span></span><span class=line><span class=cl><span class=m>1</span> packets transmitted, <span class=m>1</span> received, 0% packet loss, <span class=nb>time</span> 0ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 0.096/0.096/0.096/0.000 ms
</span></span><span class=line><span class=cl>e2d841b7a029:/# dig db
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;</span> &lt;&lt;&gt;&gt; DiG 9.18.16 &lt;&lt;&gt;&gt; db
</span></span><span class=line><span class=cl><span class=p>;;</span> global options: +cmd
</span></span><span class=line><span class=cl><span class=p>;;</span> Got answer:
</span></span><span class=line><span class=cl><span class=p>;;</span> -&gt;&gt;HEADER<span class=s>&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class=m>57615</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> flags: qr rd ra<span class=p>;</span> QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;;</span> QUESTION SECTION:
</span></span><span class=line><span class=cl><span class=p>;</span>db.                            IN      A
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;;</span> ANSWER SECTION:
</span></span><span class=line><span class=cl>db.                     <span class=m>600</span>     IN      A       172.18.0.2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;;</span> Query time: <span class=m>0</span> msec
</span></span><span class=line><span class=cl><span class=p>;;</span> SERVER: 127.0.0.11#53<span class=o>(</span>127.0.0.11<span class=o>)</span> <span class=o>(</span>UDP<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> WHEN: Tue Dec <span class=m>12</span> 03:18:39 UTC <span class=m>2023</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> MSG SIZE  rcvd: <span class=m>38</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>e2d841b7a029:/#
</span></span></code></pre></div><ul><li>Tại sao có thể thao tác phân giải tên container như vậy? Đó là nhờ một <strong>DNS nhúng</strong> ở trong Docker service.</li></ul><p><img src=https://github.com/KamranAzeem/learn-docker/raw/master/docs/images/docker-service-discovery-2.png alt></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>e2d841b7a029:/# cat /etc/resolv.conf
</span></span><span class=line><span class=cl>nameserver 127.0.0.11
</span></span><span class=line><span class=cl>options edns0 trust-ad ndots:0
</span></span><span class=line><span class=cl>e2d841b7a029:/# netstat -ntlup
</span></span><span class=line><span class=cl>Active Internet connections <span class=o>(</span>only servers<span class=o>)</span>
</span></span><span class=line><span class=cl>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 127.0.0.11:45541        0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:443             0.0.0.0:*               LISTEN      1/nginx: master pro
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:80              0.0.0.0:*               LISTEN      1/nginx: master pro
</span></span><span class=line><span class=cl>udp        <span class=m>0</span>      <span class=m>0</span> 127.0.0.11:42758        0.0.0.0:*                           -
</span></span></code></pre></div><ul><li><code>/etc/resolv.conf</code> cho thấy container đang trỏ về nameserver 127.0.0.11:53 nhưng rõ ràng không có tiến trình nào lắng nghe port 53 cả. Vậy DNS này hoạt động như thế nào?</li><li>Tiếp tục, tạo thêm 1 container khác, nhưng có nhiều <strong>quyền</strong> hơn.<ul><li><code>iptables</code> chỉ chạy khi có capabilities <code>-cap-add=NET_ADMIN and --cap-add=NET_RAW</code>.</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ docker run <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --name tool <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --network mynet <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --cap-add<span class=o>=</span>NET_ADMIN <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --cap-add<span class=o>=</span>NET_RAW <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -it wbitt/network-multitool /bin/bash
</span></span><span class=line><span class=cl>ccd72fe225c8:/# dig -c db
</span></span><span class=line><span class=cl><span class=p>;;</span> Warning, ignoring invalid class db
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;</span> &lt;&lt;&gt;&gt; DiG 9.18.16 &lt;&lt;&gt;&gt; -c db
</span></span><span class=line><span class=cl><span class=p>;;</span> global options: +cmd
</span></span><span class=line><span class=cl><span class=p>;;</span> Got answer:
</span></span><span class=line><span class=cl><span class=p>;;</span> -&gt;&gt;HEADER<span class=s>&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class=m>17778</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> flags: qr rd ra<span class=p>;</span> QUERY: 1, ANSWER: 13, AUTHORITY: 0, ADDITIONAL: <span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;;</span> OPT PSEUDOSECTION:
</span></span><span class=line><span class=cl><span class=p>;</span> EDNS: version: 0, flags:<span class=p>;</span> udp: <span class=m>65494</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> QUESTION SECTION:
</span></span><span class=line><span class=cl><span class=p>;</span>.                              IN      NS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;;</span> ANSWER SECTION:
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      d.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      l.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      k.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      i.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      j.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      e.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      h.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      g.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      a.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      f.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      c.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      b.root-servers.net.
</span></span><span class=line><span class=cl>.                       <span class=m>31133</span>   IN      NS      m.root-servers.net.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;;</span> Query time: <span class=m>8</span> msec
</span></span><span class=line><span class=cl><span class=p>;;</span> SERVER: 127.0.0.11#53<span class=o>(</span>127.0.0.11<span class=o>)</span> <span class=o>(</span>UDP<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> WHEN: Tue Dec <span class=m>12</span> 03:20:07 UTC <span class=m>2023</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> MSG SIZE  rcvd: <span class=m>239</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ccd72fe225c8:/# netstat -ntlup
</span></span><span class=line><span class=cl>Active Internet connections <span class=o>(</span>only servers<span class=o>)</span>
</span></span><span class=line><span class=cl>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 127.0.0.11:39527        0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>udp        <span class=m>0</span>      <span class=m>0</span> 127.0.0.11:35031        0.0.0.0:*                           -
</span></span><span class=line><span class=cl>ccd72fe225c8:/# iptables-nft-save
</span></span><span class=line><span class=cl><span class=c1># Generated by iptables-nft-save v1.8.9 (nf_tables) on Tue Dec 12 03:20:27 2023</span>
</span></span><span class=line><span class=cl>*nat
</span></span><span class=line><span class=cl>:PREROUTING ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
</span></span><span class=line><span class=cl>:INPUT ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
</span></span><span class=line><span class=cl>:OUTPUT ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
</span></span><span class=line><span class=cl>:POSTROUTING ACCEPT <span class=o>[</span>0:0<span class=o>]</span>
</span></span><span class=line><span class=cl>:DOCKER_OUTPUT - <span class=o>[</span>0:0<span class=o>]</span>
</span></span><span class=line><span class=cl>:DOCKER_POSTROUTING - <span class=o>[</span>0:0<span class=o>]</span>
</span></span><span class=line><span class=cl>-A OUTPUT -d 127.0.0.11/32 -j DOCKER_OUTPUT
</span></span><span class=line><span class=cl>-A POSTROUTING -d 127.0.0.11/32 -j DOCKER_POSTROUTING
</span></span><span class=line><span class=cl><span class=c1># Queries for DNS:</span>
</span></span><span class=line><span class=cl>-A DOCKER_OUTPUT -d 127.0.0.11/32 -p tcp -m tcp --dport <span class=m>53</span> -j DNAT --to-destination 127.0.0.11:39527
</span></span><span class=line><span class=cl>-A DOCKER_OUTPUT -d 127.0.0.11/32 -p udp -m udp --dport <span class=m>53</span> -j DNAT --to-destination 127.0.0.11:35031
</span></span><span class=line><span class=cl><span class=c1># Response from DNS:</span>
</span></span><span class=line><span class=cl>-A DOCKER_POSTROUTING -s 127.0.0.11/32 -p tcp -m tcp --sport <span class=m>39527</span> -j SNAT --to-source :53
</span></span><span class=line><span class=cl>-A DOCKER_POSTROUTING -s 127.0.0.11/32 -p udp -m udp --sport <span class=m>35031</span> -j SNAT --to-source :53
</span></span><span class=line><span class=cl>COMMIT
</span></span><span class=line><span class=cl><span class=c1># Completed on Tue Dec 12 03:20:27 2023</span>
</span></span></code></pre></div><ul><li><strong>iptables</strong> does magic thing! Mọi DNS query đến <code>127.0.0.11:53</code> thực tế được điều hướng sang <code>127.0.0.11:39527</code> (TCP) và <code>127.0.0.11:35031</code> (UDP).<ul><li>Thông thường, DNS sử dụng UDP cho queries nhỏ hơn 512 bytes, trên 512 bytes -> TCP.</li></ul></li></ul><p><img src=https://github.com/KamranAzeem/learn-docker/raw/master/docs/images/docker-service-discovery-1.png alt></p><blockquote><p><strong>Lưu ý</strong>: Port trên hình có thể khác với thực tế.</p></blockquote><ul><li>Chi tiết về implementation có thể tham khảo ở đây:<ul><li><a href=https://github.com/moby/moby/blob/65973c6c40a32380f4f7318de92eb6c8161742f0/daemon/container_operations_unix.go#L398>container_operations_unix.go</a></li><li><a href=https://github.com/moby/moby/blob/65973c6c40a32380f4f7318de92eb6c8161742f0/libnetwork/resolver_unix.go#L13>resolver_unix.go</a></li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>	<span class=k>case</span> <span class=nx>container</span><span class=p>.</span><span class=nx>HostConfig</span><span class=p>.</span><span class=nx>NetworkMode</span><span class=p>.</span><span class=nf>IsUserDefined</span><span class=p>():</span>
</span></span><span class=line><span class=cl>		<span class=c1>// The container uses a user-defined network. We use the embedded DNS
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// server for container name resolution and to act as a DNS forwarder
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// for external DNS resolution.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// We parse the DNS server(s) that are defined in /etc/resolv.conf on
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// the host, which may be a local DNS server (for example, if DNSMasq or
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// systemd-resolvd are in use). The embedded DNS server forwards DNS
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// resolution to the DNS server configured on the host, which in itself
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// may act as a forwarder for external DNS servers.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// If systemd-resolvd is used, the &#34;upstream&#34; DNS servers can be found in
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// /run/systemd/resolve/resolv.conf. We do not query those DNS servers
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>// directly, as they can be dynamically reconfigured.
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=o>*</span><span class=nx>sboxOptions</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span>
</span></span><span class=line><span class=cl>			<span class=o>*</span><span class=nx>sboxOptions</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>libnetwork</span><span class=p>.</span><span class=nf>OptionOriginResolvConfPath</span><span class=p>(</span><span class=s>&#34;/etc/resolv.conf&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>		<span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>default</span><span class=p>:</span>
</span></span></code></pre></div><h2 id=một-số-command-hay-ho>Một số command hay ho</h2><ul><li>Join container vào process namespace của container khác.<ul><li>Có thể thấy process mysqld của container db.</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ docker run --name busybox <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>                 --pid container:db <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>                 --rm -it busybox /bin/sh
</span></span><span class=line><span class=cl>/ <span class=c1># ps aux</span>
</span></span><span class=line><span class=cl>PID   USER     TIME  COMMAND
</span></span><span class=line><span class=cl>    <span class=m>1</span> <span class=m>999</span>       0:25 mysqld
</span></span><span class=line><span class=cl>  <span class=m>237</span> root      0:00 /bin/sh
</span></span><span class=line><span class=cl>  <span class=m>243</span> root      0:00 ps aux
</span></span><span class=line><span class=cl>/ <span class=c1># ip a</span>
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>48: eth0@if49: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu <span class=m>1500</span> qdisc noqueue
</span></span><span class=line><span class=cl>    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><ul><li>Join thêm network namespace.<ul><li>Địa chỉ IP đang là 172.18.0.2/16 (db network namespace).</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run --name busybox <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>                 --pid container:db <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>                 --network container:db --rm -it busybox /bin/sh
</span></span><span class=line><span class=cl>/ <span class=c1># ip a</span>
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>38: eth0@if39: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu <span class=m>1500</span> qdisc noqueue
</span></span><span class=line><span class=cl>    link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>/ <span class=c1># ps aux</span>
</span></span><span class=line><span class=cl>PID   USER     TIME  COMMAND
</span></span><span class=line><span class=cl>    <span class=m>1</span> <span class=m>999</span>       0:26 mysqld
</span></span><span class=line><span class=cl>  <span class=m>245</span> root      0:00 /bin/sh
</span></span><span class=line><span class=cl>  <span class=m>252</span> root      0:00 ps aux
</span></span><span class=line><span class=cl>/ <span class=c1>#</span>
</span></span></code></pre></div></div><div class=mt-16><script src=https://giscus.app/client.js data-repo=ntk148v/ntk148v.github.io data-repo-id=R_kgDOIWtaXA data-category="Show and tell" data-category-id=DIC_kwDOIWtaXM4CSU-P data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></div></article></div></main><footer class="fixed left-0 bottom-0 w-full bg-base px-page-gutter"><div class="flex justify-center items-center h-footer-height"><div class="flex flex-row w-full max-w-content justify-between lowercase italic gap-3"><nav><a href=https://ntk148v.github.io//index.xml><svg width="18" height="18" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 19.5v-.75a7.5 7.5.0 00-7.5-7.5H4.5m0-6.75h.75c7.87.0 14.25 6.38 14.25 14.25v.75M6 18.75a.75.75.0 11-1.5.0.75.75.0 011.5.0z"/></svg></a></nav><span class="text-muted hidden md:block">&copy;
2024
<a href=https://github.com/ntk148v/hugo-toigian class="font-bold hover:underline">hugo-toigian</a></span><div id=header-theme-button><svg id="dark_mode_btn" class="hidden toolbox-btn" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718.0 0118 15.75c-5.385.0-9.75-4.365-9.75-9.75.0-1.33.266-2.597.748-3.752A9.753 9.753.0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753.0 009.002-5.998z"/></svg><svg id="light_mode_btn" class="hidden toolbox-btn" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75.0 11-7.5.0 3.75 3.75.0 017.5.0z"/></svg></div></div></div></footer></body></html>