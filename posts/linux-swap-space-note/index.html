<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Swap space note | kiennt26's home</title><link rel=apple-touch-icon sizes=57x57 href=/favicon_io/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/favicon_io/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/favicon_io/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/favicon_io/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/favicon_io/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/favicon_io/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/favicon_io/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/favicon_io/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/favicon_io/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/favicon_io/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon_io/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon_io/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon_io/favicon-16x16.png><link rel=manifest href=/favicon_io/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/favicon_io/ms-icon-144x144.png"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=/css/main.min.d1017aee4fe0bb864872b99761c9da09c82ee21e703c0f7506c7779f3de249c3.css integrity="sha256-0QF67k/gu4ZIcrmXYcnaCcgu4h5wPA91Bsd3nz3iScM=" crossorigin=anonymous><script src=/js/main.23cd0c7d837263b9eaeb96ee2d9ccfa2969daa3fa00fa1c1fe8701a9b87251a1.js integrity="sha256-I80MfYNyY7nq65buLZzPopadqj+gD6HB/ocBqbhyUaE=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script></head><body><header><header><nav class=path-nav><ol><li>/
<a href=/>kiennt26's home</a>
/</li><li><a href=/posts/>Posts</a>
/</li><li class=current><a href=/posts/linux-swap-space-note/>Swap space note</a></li></ol></nav></header></header><main><h1>Swap space note</h1><div class=terms-list><ul><li><a href=/tags/linux/>[Linux]</a></li><li><a href=/tags/tech/>[Tech]</a></li></ul></div><h2 id=what-is-swap>What is Swap?</h2><p>Swap file systems support virtual memory, data is written to a swap file system when there is not enough RAM to store the data your system is processing.</p><h2 id=swap-partition-size>Swap partition size</h2><h3 id=old-rule-of-thumb>Old rule of thumb</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>swap: 2 * the-amount-of-RAM
</span></span></code></pre></div><p>So if a computer had 64KB of RAM, a swap partition of 128KB would be an optimum size. This rule took into the facts that RAM sizes were typically quite small at the time. Nowadays, RAM has become a <code>cheap</code> & <code>affordable</code> commondity, so the 2x rule is outdated.</p><h3 id=what-is-the-right-amount-of-swap-space>What is the right amount of swap space?</h3><p>Choosing the correct swap size is important. Too much swap space can hide memory leaks, also the storage space is allocated but idle. It can affect the system performance in general.</p><p>Follow the RedHat (CentOS 7x & RHEL 7) guide, the recommended size of a swap partition depending on the amount of RAM & whether you want sufficient memory for your system.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>swap &lt;= 10% * total-size-hard-drives &amp;&amp; swap &lt;= 128GB (if hibernation is allowed)
</span></span></code></pre></div><table><thead><tr><th>Amount of RAM</th><th>Recommended swap space</th><th>Recommended swap space if allowing for hibernation</th></tr></thead><tbody><tr><td>&lt; 2GB</td><td>2 * the-amount-of-RAM</td><td>3 * the-amount-of-RAM</td></tr><tr><td>> 2GB - 8GB</td><td>the-amount-of-RAM</td><td>2 * the-amount-of-RAM</td></tr><tr><td>> 8GB - 64GB</td><td>>= 4GB</td><td>1.5 * the-amount-of-RAM</td></tr><tr><td>> 64GB</td><td>>= 4GB</td><td>Hibernation not recommended</td></tr></tbody></table><h2 id=common-misconceptions--gotchas>Common misconceptions & gotchas</h2><h3 id=increasing-swap-size-would-increase-performance>Increasing swap size would increase performance</h3><ul><li>No, it wouldn&rsquo;t. Remember that the slowest part of memory is your hard-disk - <em>swap</em> just provides the ability to use more memory by swapping some pages out to the disk, which is <strong>slow</strong> compared to RAM operations. Swap can also <a href=https://askubuntu.com/questions/367881/does-swap-file-usage-increase-disk-i-o-and-cpu-load>increase disk I/O & CPU load</a>. This is a tradeoff. Without swap, the OOM may get you. It causes a downtime and in the real life scenario, the application can be slow a bit rather than down completely.</li></ul><h3 id=swappiness>Swappiness</h3><ul><li><p>The linux kernel tunable parameter <code>vm.swappiness</code> (/proc/sys/vm/swappiness) can be used to define how aggressively memory pages are swapped to disk.</p></li><li><p>The default value: <code>60</code>. The lower the value, the less swapping is used & the more memory pages are kept in the physical memory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>* 0: swap is disable.
</span></span><span class=line><span class=cl>* 1: minimum amount of swapping without disabling it entirely.
</span></span><span class=line><span class=cl>* 10: recommended value to improve performance when sufficient memory exists in a system
</span></span><span class=line><span class=cl>* 100: aggressive swapping
</span></span></code></pre></div></li><li><p>Useful commands:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Check the current value</span>
</span></span><span class=line><span class=cl>sysctl vm.swappiness
</span></span><span class=line><span class=cl><span class=c1># Adjust the value</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=m>10</span> &gt; /proc/sys/vm/swappiness
</span></span><span class=line><span class=cl>sysctl -w vm.swappiness<span class=o>=</span><span class=m>10</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;vm.swappiness: 10&#34;</span> &gt;&gt; /etc/sysctl.conf
</span></span></code></pre></div></li><li><p>On SSDs, swapping out anonymous pages and reclaiming file pages are essentially equivalent in terms of performance/latency. On older spinning disks, swap reads are slower due to random reads, so a lower vm.swappiness setting makes sense there.</p></li></ul><h3 id=using-swap-as-emergency-memory>Using swap as emergency memory</h3><ul><li>Swap is not generally about getting emergency memory, it&rsquo;s about making memory reclamation egalitarian and efficient. In fact, using it as &ldquo;emergency memory&rdquo; is generally actively harmful.</li></ul><h2 id=references>References</h2><ol><li><p><a href=https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/installation_guide/sect-disk-partitioning-setup-x86#sect-recommended-partitioning-scheme-x86>RedHad guideline</a></p></li><li><p><a href=https://chrisdown.name/2018/01/02/in-defence-of-swap.html>Chris Down&rsquo;s post</a></p></li><li><p><a href=https://linuxhint.com/understanding_vm_swappiness/>Linux Hint - Understanding vm.swappiness</a></p></li></ol><time datetime=2020-05-20>2020-05-20&nbsp;</time><div class=terminal-nav><div class=back-nav><a href=../ class=back-link>../</a></div></div></main><footer><p>Copyright 2025. All rights reserved.</p></footer></body></html>