<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Server-sent Events (SSE) | kiennt26's home</title><link rel=apple-touch-icon sizes=57x57 href=/favicon_io/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/favicon_io/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/favicon_io/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/favicon_io/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/favicon_io/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/favicon_io/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/favicon_io/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/favicon_io/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/favicon_io/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/favicon_io/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon_io/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon_io/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon_io/favicon-16x16.png><link rel=manifest href=/favicon_io/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/favicon_io/ms-icon-144x144.png"><meta name=theme-color content="#ffffff"><link rel=stylesheet href=/css/main.min.38925bdd47aabb0eb892bbce566836b59b62905bd8a5aec203df13887e0ef16f.css integrity="sha256-OJJb3Uequw64krvOVmg2tZtikFvYpa7CA98TiH4O8W8=" crossorigin=anonymous><script src=/js/main.23cd0c7d837263b9eaeb96ee2d9ccfa2969daa3fa00fa1c1fe8701a9b87251a1.js integrity="sha256-I80MfYNyY7nq65buLZzPopadqj+gD6HB/ocBqbhyUaE=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script></head><body><header><header><nav class=path-nav><ol><li>/
<a href=/>kiennt26's home</a>
/</li><li><a href=/posts/>Posts</a>
/</li><li class=current><a href=/posts/sse-fastapi/>Server-sent Events (SSE)</a></li></ol></nav></header></header><main><h1>Server-sent Events (SSE)</h1><div class=terms-list><ul><li><a href=/tags/tech/>#Tech</a></li><li><a href=/tags/sse/>#Sse</a></li></ul></div><nav class=toc><strong>Table of contents</strong><div class=toc-content><nav id=TableOfContents><ol><li><a href=#whats-sse-anyway->What&rsquo;s SSE Anyway? 🤔</a><ol><li><a href=#the-technical-bits->The Technical Bits 🔧</a></li></ol></li><li><a href=#show-me-the-code->Show Me The Code! 💻</a><ol><li><a href=#the-backend-the-chatty-friend>The Backend (The Chatty Friend)</a></li><li><a href=#the-frontend-the-patient-listener>The Frontend (The Patient Listener)</a></li></ol></li><li><a href=#why-sse->Why SSE? 🌟</a></li><li><a href=#try-it-yourself->Try It Yourself! 🚀</a></li><li><a href=#when-to-use-sse->When to Use SSE? 🤓</a></li><li><a href=#real-world-use-cases--best-practices->Real-World Use Cases & Best Practices 🎯</a><ol><li><a href=#perfect-fits-for-sse->Perfect Fits for SSE 🎯</a></li><li><a href=#best-practices->Best Practices 🏆</a></li></ol></li><li><a href=#the-end->The End 🎬</a></li><li><a href=#contributing->Contributing 🤝</a></li></ol></nav></div></nav><h1 id=the-introverts-guide-to-real-time-web-updates->The Introvert&rsquo;s Guide to Real-time Web Updates 🙈</h1><p>Ever felt like WebSocket is that extroverted friend who&rsquo;s always trying to start a conversation? &ldquo;Hey server, how are you?&rdquo; &ldquo;I&rsquo;m fine client, how are you?&rdquo; &ldquo;I&rsquo;m good too!&rdquo; 🙄</p><p>Well, meet Server-sent Events (SSE) - the introvert&rsquo;s dream come true in the world of real-time web communications. It&rsquo;s like having a friend who&rsquo;s totally cool with you just listening while they do all the talking. Perfect, right?</p><h2 id=whats-sse-anyway->What&rsquo;s SSE Anyway? 🤔</h2><p>Imagine you&rsquo;re at a soccer match, but instead of watching it live, you&rsquo;re getting updates from your chatty friend who&rsquo;s there:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Friend: &#34;Kick-off!&#34;
</span></span><span class=line><span class=cl>You: *nods silently*
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Friend: &#34;GOOOAL! Manchester United 1 - 0 Liverpool!&#34;
</span></span><span class=line><span class=cl>You: *continues nodding*
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Friend: &#34;Half-time! Still 1-0&#34;
</span></span><span class=line><span class=cl>You: *thumbs up*
</span></span></code></pre></div><p>That&rsquo;s basically SSE! The server (your friend) sends updates whenever something happens, and the client (you) just&mldr; listens. No need to ask &ldquo;what&rsquo;s happening?&rdquo; every 5 seconds like with traditional polling, or maintain a complex two-way conversation like with WebSockets.</p><h3 id=the-technical-bits->The Technical Bits 🔧</h3><p>Server-Sent Events (SSE) is a web standard that enables servers to push data to web clients via HTTP. Here&rsquo;s what makes it special:</p><ol><li><p><strong>The Connection</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>GET</span> <span class=nn>/livescore</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>text/event-stream</span>
</span></span></code></pre></div><p>The client makes a single HTTP request with <code>Accept: text/event-stream</code>, and the connection stays open. It&rsquo;s like subscribing to your friend&rsquo;s match updates on WhatsApp.</p></li><li><p><strong>The Message Format</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>event: goal  # Optional event type
</span></span><span class=line><span class=cl>data: {&#34;score&#34;: {&#34;home&#34;: 1, &#34;away&#34;: 0}}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>data: {&#34;status&#34;: &#34;Game in progress&#34;}
</span></span></code></pre></div><p>Messages are sent as UTF-8 text, with each message separated by double newlines. Like your friend sending multiple texts, but way more organized!</p></li><li><p><strong>Event Types</strong></p><ul><li><code>message</code> - Default event</li><li>Custom events (like &lsquo;goal&rsquo;, &lsquo;halftime&rsquo;, &lsquo;fulltime&rsquo;)</li><li>Each type can have its own event handler on the client</li></ul></li><li><p><strong>Built-in Goodies</strong></p><ul><li>Automatic reconnection (configurable with <code>retry: 3000</code>)</li><li>Event IDs for tracking last received message</li><li>Cross-origin support with standard CORS</li></ul></li><li><p><strong>The Not-So-Fun Parts</strong> 😅</p><ul><li><strong>Browser Connection Limits</strong>: Most browsers limit the number of open SSE connections per domain (typically 6). It&rsquo;s like your friend can only update 6 people at once!</li><li><strong>One-Way Street</strong>: No built-in way to send data back to the server. Need to chat back? You&rsquo;ll need a separate HTTP request.</li><li><strong>Plain Text Only</strong>: Unlike WebSocket, SSE only supports UTF-8 text data. Binary data? Sorry, you&rsquo;ll need to encode it first.</li><li><strong>Proxy Issues</strong>: Some proxy servers don&rsquo;t play nice with long-lived connections. They might think your friend fell asleep and cut the connection!</li><li><strong>Header Size Limits</strong>: Some servers have a maximum header size limit, which can affect reconnection with large <code>Last-Event-ID</code> headers.</li></ul></li></ol><h2 id=show-me-the-code->Show Me The Code! 💻</h2><p>We&rsquo;ve built a simple soccer livescore system using FastAPI and SSE: <a href=https://github.com/ntk148v/sse-fastapi>https://github.com/ntk148v/sse-fastapi</a></p><p>Let&rsquo;s break down how it works:</p><h3 id=the-backend-the-chatty-friend>The Backend (The Chatty Friend)</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 1. First, we set up our FastAPI app with CORS support</span>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&#34;Soccer Livescore SSE API&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>add_middleware</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>CORSMiddleware</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>allow_origins</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;*&#34;</span><span class=p>],</span>  <span class=c1># In production, specify your domains!</span>
</span></span><span class=line><span class=cl>    <span class=n>allow_credentials</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>allow_methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;*&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>allow_headers</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;*&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Our event generator - the heart of SSE</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>livescore_generator</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Our enthusiastic commentator&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>load_mock_data</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>update</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Format: &#34;data: {json_data}\n\n&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=sa>f</span><span class=s2>&#34;data: </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>update</span><span class=p>)</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>  <span class=c1># Taking a breath between updates</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. The SSE endpoint</span>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/livescore&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>livescore</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>StreamingResponse</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>livescore_generator</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=n>media_type</span><span class=o>=</span><span class=s2>&#34;text/event-stream&#34;</span><span class=p>,</span>  <span class=c1># Magic happens here!</span>
</span></span><span class=line><span class=cl>        <span class=n>headers</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Cache-Control&#34;</span><span class=p>:</span> <span class=s2>&#34;no-cache&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Connection&#34;</span><span class=p>:</span> <span class=s2>&#34;keep-alive&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></div><p>Let&rsquo;s break down what&rsquo;s happening:</p><ol><li>The <code>CORSMiddleware</code> allows our frontend to connect from any origin</li><li><code>livescore_generator()</code> is an async generator that:<ul><li>Loads match data (in real life, this would be live data)</li><li>Yields properly formatted SSE messages</li><li>Uses <code>asyncio.sleep()</code> to simulate real-time updates</li></ul></li><li><code>StreamingResponse</code> keeps the connection open and streams data</li></ol><h3 id=the-frontend-the-patient-listener>The Frontend (The Patient Listener)</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 1. Create the connection
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>eventSource</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventSource</span><span class=p>(</span><span class=s2>&#34;http://localhost:8000/livescore&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 2. Set up our event handlers
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>eventSource</span><span class=p>.</span><span class=nx>onopen</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Connection established!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>eventSource</span><span class=p>.</span><span class=nx>onmessage</span> <span class=o>=</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Parse the JSON data from the event
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Update our UI with the new match data
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>updateMatch</span><span class=p>(</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>eventSource</span><span class=p>.</span><span class=nx>onerror</span> <span class=o>=</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s2>&#34;Connection lost! Attempting to reconnect...&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// The browser will automatically try to reconnect
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 3. Update the UI with the match data
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>updateMatch</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Update score
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;.score&#34;</span><span class=p>).</span><span class=nx>textContent</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=sb>`</span><span class=si>${</span><span class=nx>data</span><span class=p>.</span><span class=nx>score</span><span class=p>.</span><span class=nx>home</span><span class=si>}</span><span class=sb> - </span><span class=si>${</span><span class=nx>data</span><span class=p>.</span><span class=nx>score</span><span class=p>.</span><span class=nx>away</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Update match status
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;.match-status&#34;</span><span class=p>).</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>data</span><span class=p>.</span><span class=nx>status</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ... more UI updates
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><h2 id=why-sse->Why SSE? 🌟</h2><ol><li><p><strong>It&rsquo;s HTTP</strong>: No special protocols, no weird handshakes, just good old HTTP. Your server can finally stop pretending it knows WebSocket dance moves.</p></li><li><p><strong>Auto-reconnect</strong>: Like a clingy friend, it&rsquo;ll keep trying to reconnect if the connection drops. No need to implement retry logic!</p></li><li><p><strong>One-way communication</strong>: Perfect for when your client is in &ldquo;introvert mode&rdquo; and just wants to receive updates without the pressure of responding.</p></li><li><p><strong>Built-in event types</strong>: Want to categorize your updates? SSE has built-in event types! It&rsquo;s like having different chat groups for different topics.</p></li></ol><h2 id=try-it-yourself->Try It Yourself! 🚀</h2><ol><li><p>Clone this repo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/ntk148v/sse-fastapi.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> sse-fastapi
</span></span></code></pre></div></li><li><p>Install dependencies (we use <code>uv</code> because we&rsquo;re cool):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv venv .venv
</span></span><span class=line><span class=cl>. .venv/bin/activate
</span></span><span class=line><span class=cl>uv pip install -e .
</span></span></code></pre></div></li><li><p>Run the server:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python main.py
</span></span></code></pre></div></li><li><p>Open http://localhost:8000 in your browser and watch the soccer match unfold!</p></li></ol><p><img src="https://raw.githubusercontent.com/ntk148v/sse-fastapi/refs/heads/master/sse-sample.gif?token=GHSAT0AAAAAADCSDBD3ECSYB2HNRIMMT4ZI2CH2L7A" alt></p><h2 id=when-to-use-sse->When to Use SSE? 🤓</h2><p>Use SSE when:</p><ul><li>You need real-time updates</li><li>The data flow is mostly server → client</li><li>You want to keep things simple</li><li>Your server is feeling particularly chatty</li></ul><p>Don&rsquo;t use SSE when:</p><ul><li>You need two-way communication (use WebSocket)</li><li>Your server has social anxiety</li><li>You&rsquo;re building a multiplayer game (unless it&rsquo;s a very slow chess match)</li></ul><h2 id=real-world-use-cases--best-practices->Real-World Use Cases & Best Practices 🎯</h2><h3 id=perfect-fits-for-sse->Perfect Fits for SSE 🎯</h3><ol><li><p><strong>Live Sports Updates</strong></p><ul><li>Real-time scores (like our example!)</li><li>Play-by-play commentary</li><li>Team statistics</li></ul></li><li><p><strong>Financial Applications</strong></p><ul><li>Stock price updates</li><li>Currency exchange rates</li><li>Trading notifications</li></ul></li><li><p><strong>Social Media Features</strong></p><ul><li>News feeds</li><li>Notification systems</li><li>Like/comment counters</li></ul></li><li><p><strong>System Monitoring</strong></p><ul><li>Server health metrics</li><li>Log streaming</li><li>Resource usage stats</li></ul></li><li><p><strong>Content Management</strong></p><ul><li>Content update notifications</li><li>Publishing status</li><li>Collaborative editing notifications</li></ul></li></ol><h3 id=best-practices->Best Practices 🏆</h3><ol><li><p><strong>Connection Management</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Always handle reconnection gracefully
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>connect</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>eventSource</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventSource</span><span class=p>(</span><span class=s2>&#34;/events&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>eventSource</span><span class=p>.</span><span class=nx>onerror</span> <span class=o>=</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>eventSource</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>connect</span><span class=p>,</span> <span class=mi>5000</span><span class=p>);</span> <span class=c1>// Custom reconnect logic
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>eventSource</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div></li><li><p><strong>Event ID Tracking</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Server-side</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>generator</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=sa>f</span><span class=s2>&#34;id: </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=se>\n</span><span class=s2>data: </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>data</span><span class=p>)</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Client-side</span>
</span></span><span class=line><span class=cl><span class=n>eventSource</span><span class=o>.</span><span class=n>addEventListener</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=p>(</span><span class=n>e</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>localStorage</span><span class=o>.</span><span class=n>setItem</span><span class=p>(</span><span class=s1>&#39;lastEventId&#39;</span><span class=p>,</span> <span class=n>e</span><span class=o>.</span><span class=n>lastEventId</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div></li><li><p><strong>Resource Management</strong></p><ul><li>Keep payload sizes small (&lt; 10KB recommended)</li><li>Batch updates when possible</li><li>Use compression for large datasets</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Batch updates example</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>batch_generator</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>updates</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>updates</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>updates</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>5</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>yield</span> <span class=sa>f</span><span class=s2>&#34;data: </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>updates</span><span class=p>)</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>updates</span> <span class=o>=</span> <span class=p>[]</span>
</span></span></code></pre></div></li><li><p><strong>Error Handling</strong></p><ul><li>Always include error events</li><li>Implement custom retry logic when needed</li><li>Monitor connection health</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Server-side error handling</span>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/stream&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>stream</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>StreamingResponse</span><span class=p>(</span><span class=n>generator</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=sa>f</span><span class=s2>&#34;event: error</span><span class=se>\n</span><span class=s2>data: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span></code></pre></div></li><li><p><strong>Security Considerations</strong></p><ul><li>Implement proper authentication</li><li>Use HTTPS in production</li><li>Rate limit connections per client</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Basic rate limiting example</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>HTTPException</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>CLIENTS</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=n>MAX_CONNECTIONS</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/stream&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>stream</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>client_ip</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>host</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>CLIENTS</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>client_ip</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=n>MAX_CONNECTIONS</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=mi>429</span><span class=p>,</span> <span class=s2>&#34;Too many connections&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>CLIENTS</span><span class=p>[</span><span class=n>client_ip</span><span class=p>]</span> <span class=o>=</span> <span class=n>CLIENTS</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>client_ip</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span></span></code></pre></div></li><li><p><strong>Production Tips</strong></p><ul><li>Use a load balancer that supports long polling</li><li>Implement heartbeat messages</li><li>Monitor server resources</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Heartbeat example</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>generator_with_heartbeat</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=s2>&#34;:</span><span class=se>\n\n</span><span class=s2>&#34;</span>  <span class=c1># Heartbeat</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span>
</span></span></code></pre></div></li></ol><h2 id=the-end->The End 🎬</h2><p>So there you have it! SSE is like having a friend who&rsquo;s happy to keep you updated without expecting you to respond. It&rsquo;s perfect for live scores, news feeds, status updates, or any situation where you just want to sit back and let the data flow.</p><p>Remember: In a world of chatty WebSockets, sometimes it&rsquo;s okay to be a quiet SSE. 🤫</p><h2 id=contributing->Contributing 🤝</h2><p>Found a bug? Want to add features? Feel free to create an issue or submit a PR. Just remember to be nice - this is a judgment-free zone for both extroverted WebSockets and introverted SSEs!</p><time datetime=2025-06-10>2025-06-10&nbsp;</time><div class=terminal-nav><div class=back-nav><a href=../ class=back-link>../</a></div></div></main><footer><p>&copy; Copyright 2025 &#183;
<a href=https://github.com/ntk148v/shibui>shibui</a></p></footer></body></html>